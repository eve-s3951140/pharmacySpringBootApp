<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>Suppliers</title>
    <link rel="stylesheet" href="/css/pharmacy.css" />
  </head>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Display rows that match the search query (search by supplier name)
      document.getElementById("search").addEventListener("keyup", function () {
        const query = this.value.toLowerCase(); // Get the search query in lowercase
        const rows = document.querySelectorAll("table tr");

        rows.forEach((row, index) => {
          // Skip the header row
          if (index === 0) return;

          const name = row.querySelector("td:nth-child(2)"); // Supplier Name column
          if (name) {
            const text = name.textContent.toLowerCase(); // Convert supplier name to lowercase
            const match = text.includes(query); // Check if supplier name includes the query
            row.style.display = match ? "" : "none"; // Show or hide the row
          }
        });
      });
      // Get the modal
      var modal = document.getElementById("addSupplierModal");

      // Get the add icon
      var addIcon = document.querySelector(".add-icon");

      // Get the <span> element that closes the modal
      var closeBtn = document.querySelector(".modal .close");

      // When the user clicks the add icon, open the modal
      addIcon.onclick = function () {
        modal.style.display = "block";
      };

      // When the user clicks on <span> (x), close the modal
      closeBtn.onclick = function () {
        modal.style.display = "none";
      };

      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function (event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      };
    });
  </script>
  <body>
    <!-- Navigation Bar -->
    <div class="navbar">
      <a href="/homepage">Home</a>
      <a href="/medicines">Medicines</a>
      <a href="/equipments">Equipments</a>
      <a href="javascript:void(0)" class="active">Suppliers</a>
    </div>

    <!-- Page Content -->
    <div class="content">
      <h1>Suppliers</h1>
      <p>
        There are <span th:text="${suppliers.size()}">0</span> suppliers in the
        inventory.
      </p>

      <!-- Search Bar -->
      <div class="search-container">
        <input
          type="text"
          id="search"
          name="search"
          placeholder="Search by supplier name..."
        />
        <img
          src="/images/addIcon.png"
          alt="Add New Supplier"
          class="add-icon"
        />
      </div>

      <!-- Equipments table -->
      <table>
        <tr>
          <th style="width: 5%">Supplier ID</th>
          <th>Supplier Name</th>
          <th style="width: 5%">Contact Number</th>
          <th style="width: 5%">Actions</th>
        </tr>
        <tr th:each="supplier : ${suppliers}">
          <td th:text="${supplier.id}">Product ID</td>
          <td th:text="${supplier.name}">Supplier Name</td>
          <td th:text="${supplier.contact}">Contact</td>
          <td>
            <button style="margin-right: 5px">
              <img src="/images/editIcon.png" alt="Edit" />
            </button>
            <button>
              <img src="/images/deleteIcon.png" alt="Delete" />
            </button>
          </td>
        </tr>
      </table>
    </div>
    <!-- Modal Structure -->
    <div id="addSupplierModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Add New Supplier</h2>
        <form th:action="@{/suppliers/add}" method="post" class="supplier-form">
          <label for="name">Supplier Name:</label>
          <input type="text" id="name" name="name" required />

          <label for="contact">Contact Number:</label>
          <input type="text" id="contact" name="contact" required />

          <button type="submit">Add Supplier</button>
        </form>
      </div>
    </div>
  </body>
</html>
